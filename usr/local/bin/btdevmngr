#!/bin/sh -l

# Part of tiny-radioCD project, originally designed & hand-crafted by macmpi
# check License at project home https://github.com/macmpi/tiny-radioCD


# Bluetooth devices mays connect/disconnect frequently
# Some devices like remotes issue multiples /dev/input
# Lets relaunch acpid and then relink mpd on reconnected speaker

# $1 contains input/eventX


# restart acpid to manage new input device
# restart each time new input comes-up (but not during boot)
[ -f /var/run/acpid.pid ] && /sbin/service acpid restart

# busybox bug: acpid may be crashed at boot if no input dev (hence no pid file) 
service acpid status 2>&1 | grep -q crashed && /sbin/service acpid restart

relink-spkr $1 &
